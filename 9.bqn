inâ†â€¢file.Chars "input/9.txt"
# inâ†"2333133121414131402"

Part1â†{
	xsâ†âˆ¾â†•âˆ˜â‰ âŠ¸({2|ğ•¨?('0'-Ëœğ•©)/â¥ŠÂ¯1;('0'-Ëœğ•©)/â¥Šğ•¨Ã·2}Â¨)ğ•©
	{ğ•Š: xs (Â¯1â†“(âŠ¢Â´xs)âŒ¾((âŠ‘xsâŠÂ¯1)âŠ¸âŠ‘))â†© }â€¢_while_{ğ•Š: âŠ‘Â¯1âˆŠxs} âŸ¨âŸ©
	+Â´â†•âˆ˜â‰ âŠ¸Ã—xs
}

Part2â†{
	lensâ†'0'-Ëœğ•©
	valsâ†âŒŠâŠ¸=âŠ¸(Ã—+Â¯1Ã—Â¬âˆ˜âŠ£)Ã·âŸœ2â†•â‰ ğ•©
	resultâ†0
	indexâ†0
	{ğ•Š:
		lâ†âŠ‘lens
		lensâ†“Ëœâ†©1
		vâ†âŠ‘vals
		valsâ†“Ëœâ†©1
		{
			Â¯1â‰ v?
				result+â†©+Â´vÃ—index+â†•l
				index+â†©l;
			possibleâ†/(Â¯1â‰ vals)âˆ§(lâ‰¥lens)
			0â‰ â‰ possible? {
				selectedâ†âŠ¢Â´possible
				result+â†©(selectedâŠ‘vals)Ã—+Â´index+â†•selectedâŠ‘lens
				index+â†©selectedâŠ‘lens
				vals Â¯1âŒ¾(selectedâŠ¸âŠ‘)â†©
				l>selectedâŠ‘lens?
					valsâˆ¾Ëœâ†©Â¯1
					lensâˆ¾Ëœâ†©l-selectedâŠ‘lens
				; âŸ¨âŸ©
			}; index+â†©l
		}
	}â€¢_while_{ğ•Š:0â‰ â‰ vals} âŸ¨âŸ©
	result
}

â€¢Show (Part1â‹ˆPart1â€¢_timed) in
â€¢Show (Part2â‹ˆPart2â€¢_timed) in
